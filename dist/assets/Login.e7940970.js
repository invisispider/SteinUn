import{d as p,u as h,r as u,a as f,c as g,w as c,v as d,b as a,e as _,f as w,g as v,o as I}from"./index.b76d7ea5.js";import{o as y,g as U,f as b,a as A,b as i,s as R}from"./firebaseconfig.e85906bf.js";const k=a("h2",null,"Kenny Logins",-1),S=a("i",{class:"material-icons"},"supervisor_account",-1),V=a("i",{class:"material-icons"},"password",-1),x=a("input",{type:"submit",name:"submit"},null,-1),B=a("i",{class:"material-icons"},"grade",-1),C=a("br",null,null,-1),D=a("i",{class:"material-icons christmas-icon"},"build",-1),L=p({__name:"Login",setup(N){const e=h();v();const r=u(""),l=u(""),m=()=>{R(i,l.value,r.value).then(t=>{const n=t.user;e.setUid(n.uid),e.setIsIn(),e.setAuthIsReady(),i.currentUser!==null&&i.currentUser.getIdTokenResult().then(s=>{s.claims.admin&&(console.info("Admin logged in"),e.setAdmin())}).catch(s=>{console.log(s)})}).catch(t=>{console.error(t.code,t.message)})};return y(i,async t=>{if(t){e.setIsIn(),e.setUid(await t.uid);const n=U(b,"users",t.uid),s=await A(n);if(s){let o=await s.data();o&&o.username&&e.setUsername(o.username)}else console.error("No user listing in database!");e.setAuthIsReady(),i.currentUser&&i.currentUser.getIdTokenResult().then(o=>{o.claims.admin&&(console.info("Admin on state change"),e.setAdmin())}).catch(o=>{console.error(o.code,o.message)})}else e.setAuthIsReady(),console.info("auth ready")}),(t,n)=>f(e).username?w("",!0):(I(),g("form",{key:0,class:"login",onSubmit:_(m,["prevent"]),autocomplete:"on",method:"dialog"},[k,c(a("input",{type:"email",name:"username",autocomplete:"username email","onUpdate:modelValue":n[0]||(n[0]=s=>l.value=s)},null,512),[[d,l.value]]),S,c(a("input",{type:"password",name:"password",autocomplete:"current-password","onUpdate:modelValue":n[1]||(n[1]=s=>r.value=s)},null,512),[[d,r.value]]),V,x,B,C,D],32))}});export{L as default};
